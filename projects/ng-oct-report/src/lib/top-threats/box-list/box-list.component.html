<div class="box">
    <div class="title">
        <span><b>{{title}}</b> <span *ngIf="title !== 'Baselines'" style="color:red"> *</span></span>
    </div>
    <ng-container *ngIf="arrayList.length > 0; else empty">
        <mat-list>
            <div *ngFor="let item of groupedArrayListBySeverity | keyvalue">
                <div class="summary" *ngIf="type !== 'baseline deviation'; else baseline">
                    <span class="icon" [ngSwitch]="item.key">
                        <mat-icon *ngSwitchCase="'critical'" class="critical" mat-list-icon>error</mat-icon>
                        <mat-icon *ngSwitchCase="'danger'" class="danger" mat-list-icon>warning</mat-icon>
                        <mat-icon *ngSwitchCase="'warning'" class="warning" mat-list-icon>warning_outlined</mat-icon>
                        {{item.value.length}} {{title === 'Baselines' ? '' : item.key}} new {{item.value.length > 1?
                        type +
                        's' : type}}
                    </span>
                    <div class="row-item">
                        <span *ngIf="title === 'Alerts'; else user">
                            {{item.value[0][keys[1]]}} - {{item.value[0][keys[2]]}}
                            <ng-container *ngIf="item.value.length>1">
                                <br>
                                <b>and more...</b>
                            </ng-container>
                        </span>
                    </div>
                    <!-- <div>
                        <mat-list>
                            <mat-list-item *ngFor="let a of item.value">
                                <div class="flex-col">
                                    <div class="row-item">
                                        <span>{{a[keys[0]] | date:	'd/MM/y, h:mm:ss a z'}} |</span>
                                        <span>{{a[keys[1]]}}</span>
                                    </div>
                                    <div class="row-item">
                                        <span>{{a[keys[2]]}}</span>
                                    </div>
                                </div>
                            </mat-list-item>
                        </mat-list>
                    </div> -->
                </div>
                <ng-template #baseline>

                    <div class="flex-col">
                        <p style="text-decoration: underline dotted;text-underline-offset: 3px; 
                        margin-block-start: 0;">Current Compliance Posture</p>
                        <div class="flex-row">
                            <div class="row-item">
                                <div class="row-item"><span style="line-height: 2">Tenant</span></div>
                                <div class="row-item"><span>Passing: </span> <span style="float:right; color:green">
                                        {{ !!tenant_posture_counts?.not_deviated? tenant_posture_counts?.not_deviated: '-'}}</span>
                                </div>
                                <div class="row-item"><span>Deviating: </span> <span
                                        style="float:right; color:red">{{!!tenant_posture_counts?.has_deviated? tenant_posture_counts?.has_deviated: '-'}}</span>
                                </div>
                            </div>
                            <div class="row-item">
                                <div class="row-item"><span style="line-height: 2">Group </span></div>
                                <div class="row-item"><span>Passing: </span> <span style="float:right; color:green">
                                        {{ !!group_posture_counts?.not_deviated? group_posture_counts?.not_deviated: '-'}}</span>
                                </div>
                                <div class="row-item"><span>Deviating: </span> <span
                                        style="float:right; color:red">{{!!group_posture_counts?.has_deviated? group_posture_counts?.has_deviated: '-'}}</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="summary">
                        <p><span style="text-decoration: underline dotted;text-underline-offset: 3px;">In this
                                period</span> <span style="color:red"> *</span></p>
                        <span class="icon">
                            <mat-icon class="critical" mat-list-icon>error</mat-icon>
                            {{item.value.length}} {{title === 'Baselines' ? '' : item.key}} new {{item.value.length > 1?
                            type +
                            's' : type}}
                        </span>
                        <div class="row-item">
                            <ng-container *ngFor="let a of (item.value | slice:0:2);last as l">
                                {{a[keys[1]]}} - {{a[keys[2]]}}{{!l? ',' : ''}}
                            </ng-container>
                            <ng-container *ngIf="item.value.length>1">
                                <br>
                                <b>and more...</b>
                            </ng-container>
                        </div>
                    </div>
                </ng-template>

                <ng-template #user>
                    <span>{{item.value[0][keys[2]]}}
                        <ng-container *ngIf="item.value.length>1">
                            <br>
                            <b>and more...</b>
                        </ng-container>
                    </span>
                </ng-template>
            </div>
        </mat-list>
    </ng-container>

</div>

<ng-template #empty>
    <p class="icon">
        <mat-icon class="safe" mat-list-icon>task_alt</mat-icon>
        No threats were found
    </p>
</ng-template>