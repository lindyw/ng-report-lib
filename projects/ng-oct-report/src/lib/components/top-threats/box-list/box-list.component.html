<div class="box" [class.pagebreak]="title === 'Alerts'">
  <div class="title">
    <h3>
      <b>{{ title }}</b> <span *ngIf="title !== 'Baselines'" style="color: red"> *</span>
    </h3>
  </div>
  <!-- Alert Content -->
  <ng-container *ngIf="type === 'event' && arrayList.length > 0">
    <mat-list>
      <div style="width: 90%" *ngFor="let item of groupedArrayListBySeverity | keyvalue">
        <div class="summary">
          <span class="icon" [ngSwitch]="item.key">
            <mat-icon *ngSwitchCase="'critical'" class="critical" mat-list-icon>error</mat-icon>
            <mat-icon *ngSwitchCase="'danger'" class="danger" mat-list-icon>warning</mat-icon>
            <mat-icon *ngSwitchCase="'warning'" class="warning" mat-list-icon>warning_outlined</mat-icon>
            {{ item.value.length }} {{ title === 'Baselines' ? '' : item.key }} new
            {{ item.value.length > 1 ? type + 's' : type }}
          </span>
          <div class="row-item">
            <span *ngIf="title === 'Alerts'; else user">
              {{ item.value[0][keys[1]] }} - {{ item.value[0][keys[2]] }}
              <ng-container *ngIf="item.value.length > 1">
                <br />
                <b>and more...</b>
              </ng-container>
            </span>
          </div>
        </div>

        <ng-template #user>
          <span
            >{{ item.value[0][keys[2]] }}
            <ng-container *ngIf="item.value.length > 1">
              <br />
              <b>and more...</b>
            </ng-container>
          </span>
        </ng-template>
      </div>
    </mat-list>
  </ng-container>

  <!-- Baseline Content -->
  <ng-container *ngIf="type === 'baseline deviation'">
    <mat-list>
      <div class="flex-col">
        <h4 style="margin-block: 0">Current Posture Summary (All time)</h4>
        <div class="flex-row">
          <div class="row-item">
            <div class="row-item">
              <span style="line-height: 2"><b>Tenant</b></span>
            </div>
            <div class="row-item">
              <span>Passing: </span>
              <span style="float: right; color: green">
                {{ !!tenant_posture_counts?.not_deviated ? tenant_posture_counts?.not_deviated : '-' }}</span
              >
            </div>
            <div class="row-item">
              <span>Deviating: </span>
              <span style="float: right; color: red">{{
                !!tenant_posture_counts?.has_deviated ? tenant_posture_counts?.has_deviated : '-'
              }}</span>
            </div>
          </div>
          <div class="row-item">
            <div class="row-item">
              <span style="line-height: 2"><b>Group</b></span>
            </div>
            <div class="row-item">
              <span>Passing: </span>
              <span style="float: right; color: green">
                {{ !!group_posture_counts?.not_deviated ? group_posture_counts?.not_deviated : '-' }}</span
              >
            </div>
            <div class="row-item">
              <span>Deviating: </span>
              <span style="float: right; color: red">{{
                !!group_posture_counts?.has_deviated ? group_posture_counts?.has_deviated : '-'
              }}</span>
            </div>
          </div>
        </div>
      </div>
    </mat-list>
    <div class="summary">
      <h4 style="margin-block-end: 0.5rem">Posture Summary (In this period) <span style="color: red"> *</span></h4>
      <div
        *ngIf="
          tenant_baselines_posture_controls_in_this_period !== null &&
            group_baselines_posture_controls_in_this_period !== null;
          else empty
        "
      >
        <lib-posture-line-chart
          *ngIf="!!tenant_baselines_posture_controls_in_this_period"
          [title]="'Tenant Baselines Posture Summary Chart'"
          [postureData]="tenant_baselines_posture_controls_in_this_period"
        ></lib-posture-line-chart>
        <lib-posture-line-chart
          *ngIf="!!group_baselines_posture_controls_in_this_period"
          [title]="'Group Baselines Posture Summary Chart'"
          [postureData]="group_baselines_posture_controls_in_this_period"
        ></lib-posture-line-chart>
        <!-- <div style="width: 90%" *ngFor="let item of groupedArrayListBySeverity | keyvalue">
          <div class="flex-row">
            <span class="icon">
              <mat-icon class="critical" mat-list-icon>error</mat-icon>
              {{ item.value.length }} {{ title === 'Baselines' ? '' : item.key }} new
              {{ item.value.length > 1 ? type + 's' : type }}
            </span>
            <div class="row-item">
              <ng-container *ngFor="let a of item.value | slice: 0:2; last as l">
                {{ a[keys[1]] }} - {{ a[keys[2]] }}{{ !l ? ',' : '' }}
              </ng-container>
              <ng-container *ngIf="item.value.length > 1">
                <br />
                <b>and more...</b>
              </ng-container>
            </div>
          </div>
        </div> -->
      </div>
    </div>
  </ng-container>

  <ng-template #empty>
    <p class="icon">
      <mat-icon class="safe" mat-list-icon>task_alt</mat-icon>
      No threats were found
    </p>
  </ng-template>
</div>
